'use strict';

var through = require('through2');

module.exports = fileCount;

///

// bundle処理されたファイル数を表示するプラグイン
function fileCount(browserify) {
	browserify.on('bundle', function(bundle) {
		var file_count = 0;

		bundle.on('end', function () {
			console.error('file count:', file_count, '(by file-count plugin)');
		});

		var stream = through.obj(
			function transform(row, enc, next) {
				file_count++;
				this.push(row);
				next();
			});
		browserify.pipeline.get('deps').push(stream);
	});

	return browserify;
}
